      function premgegrvelo(modetype,omega)
      common /plevel/iprtlv
      logical splined
      dimension tcube(3,641)
      dimension scube(3,691)
      dimension work(3,1000)
c     there are 641 toroidal modes to spline
c     there are 691 spheroidal modes to spline
      dimension tomega( 641)
      dimension tpvel( 641)
      dimension somega( 691)
      dimension spvel( 691)
      save
      data ntspl,nsspl / 641, 691/
      data splined/.false./
c
      data tomega /
     # 0.00238238,0.00368296,0.00481078,0.00583232,0.00677851,0.00766991,
     # 0.00852072,0.00934066,0.01013646,0.01091296,0.01167379,0.01242180,
     # 0.01315925,0.01388803,0.01460963,0.01532531,0.01603612,0.01674291,
     # 0.01744640,0.01814716,0.01884570,0.01954241,0.02023762,0.02093162,
     # 0.02162463,0.02231681,0.02300836,0.02369938,0.02438999,0.02508028,
     # 0.02577032,0.02646016,0.02714987,0.02783948,0.02852901,0.02921851,
     # 0.02990798,0.03059744,0.03128691,0.03197641,0.03266592,0.03335546,
     # 0.03404504,0.03473467,0.03542432,0.03611401,0.03680375,0.03749353,
     # 0.03818334,0.03887319,0.03956307,0.04025297,0.04094291,0.04163286,
     # 0.04232284,0.04301283,0.04370283,0.04439285,0.04508287,0.04577290,
     # 0.04646293,0.04715297,0.04784299,0.04853301,0.04922302,0.04991302,
     # 0.05060300,0.05129296,0.05198290,0.05267281,0.05336270,0.05405255,
     # 0.05474238,0.05543216,0.05612191,0.05681162,0.05750129,0.05819090,
     # 0.05888048,0.05957000,0.06025946,0.06094887,0.06163823,0.06232752,
     # 0.06301675,0.06370591,0.06439502,0.06508405,0.06577300,0.06646188,
     # 0.06715070,0.06783942,0.06852807,0.06921664,0.06990512,0.07059351,
     # 0.07128182,0.07197004,0.07265816,0.07334618,0.07403411,0.07472194,
     # 0.07540967,0.07609729,0.07678481,0.07747222,0.07815952,0.07884671,
     # 0.07953378,0.08022073,0.08090757,0.08159429,0.08228088,0.08296735,
     # 0.08365369,0.08433990,0.08502598,0.08571193,0.08639774,0.08708341,
     # 0.08776895,0.08845434,0.08913958,0.08982468,0.09050963,0.09119444,
     # 0.09187908,0.09256357,0.09324790,0.09393207,0.09461608,0.09529992,
     # 0.09598360,0.09666710,0.09735043,0.09803360,0.09871657,0.09939939,
     # 0.10008200,0.10076445,0.10144669,0.10212876,0.10281062,0.10349231,
     # 0.10417378,0.10485508,0.10553615,0.10621703,0.10689768,0.10757814,
     # 0.10825840,0.10893843,0.10961825,0.11029785,0.11097722,0.11165637,
     # 0.11233529,0.11301398,0.11369244,0.11437066,0.11504863,0.11572637,
     # 0.11640386,0.11708110,0.11775810,0.11843483,0.11911132,0.11978755,
     # 0.12046353,0.12113923,0.12181467,0.12248984,0.12316474,0.12383936,
     # 0.12451369,0.12518775,0.12586153,0.12653501,0.12720822,0.12788111,
     # 0.12855372,0.12922603,0.12989803,0.13056971,0.13124110,0.13191219,
     # 0.13258293,0.13325338,0.13392350,0.13459329,0.13526276,0.13593189,
     # 0.13660070,0.13726917,0.13793729,0.13860507,0.13927251,0.13993959,
     # 0.14060633,0.14127271,0.14193873,0.14260440,0.14326969,0.14393461,
     # 0.14459917,0.14526334,0.14592715,0.14659058,0.14725360,0.14791626,
     # 0.14857852,0.14924039,0.14990187,0.15056294,0.15122361,0.15188389,
     # 0.15254375,0.15320320,0.15386224,0.15452085,0.15517907,0.15583684,
     # 0.15649420,0.15715112,0.15780762,0.15846367,0.15911929,0.15977448,
     # 0.16042922,0.16108352,0.16173738,0.16239077,0.16304372,0.16369621,
     # 0.16434824,0.16499981,0.16565092,0.16630156,0.16695175,0.16760144,
     # 0.16825068,0.16889943,0.16954771,0.17019551,0.17084281,0.17148964,
     # 0.17213598,0.17278183,0.17342719,0.17407206,0.17471643,0.17536029,
     # 0.17600366,0.17664653,0.17728890,0.17793076,0.17857212,0.17921296,
     # 0.17985329,0.18049312,0.18113242,0.18177120,0.18240948,0.18304722,
     # 0.18368445,0.18432117,0.18495734,0.18559301,0.18622814,0.18686274,
     # 0.18749681,0.18813036,0.18876338,0.18939586,0.19002780,0.19065921,
     # 0.19129008,0.19192041,0.19255023,0.19317949,0.19380820,0.19443639,
     # 0.19506402,0.19569112,0.19631767,0.19694369,0.19756915,0.19819407,
     # 0.19881846,0.19944228,0.20006557,0.20068832,0.20131050,0.20193215,
     # 0.20255326,0.20317380,0.20379381,0.20441326,0.20503217,0.20565054,
     # 0.20626834,0.20688561,0.20750232,0.20811850,0.20873411,0.20934919,
     # 0.20996371,0.21057770,0.21119112,0.21180400,0.21241634,0.21302813,
     # 0.21363938,0.21425007,0.21486023,0.21546984,0.21607891,0.21668743,
     # 0.21729541,0.21790284,0.21850973,0.21911608,0.21972190,0.22032717,
     # 0.22093190,0.22153610,0.22213975,0.22274287,0.22334546,0.22394751,
     # 0.22454903,0.22515000,0.22575045,0.22635037,0.22694975,0.22754861,
     # 0.22814694,0.22874475,0.22934201,0.22993876,0.23053499,0.23113069,
     # 0.23172587,0.23232053,0.23291467,0.23350829,0.23410138,0.23469397,
     # 0.23528604,0.23587760,0.23646864,0.23705918,0.23764920,0.23823872,
     # 0.23882772,0.23941623,0.24000423,0.24059172,0.24117871,0.24176520,
     # 0.24235119,0.24293669,0.24352169,0.24410619,0.24469021,0.24527372,
     # 0.24585675,0.24643929,0.24702133,0.24760288,0.24818397,0.24876456,
     # 0.24934468,0.24992432,0.25050348,0.25108215,0.25166038,0.25223809,
     # 0.25281537,0.25339216,0.25396848,0.25454432,0.25511971,0.25569463,
     # 0.25626910,0.25684309,0.25741664,0.25798970,0.25856236,0.25913450,
     # 0.25970623,0.26027751,0.26084831,0.26141870,0.26198861,0.26255810,
     # 0.26312715,0.26369572,0.26426390,0.26483160,0.26539889,0.26596573,
     # 0.26653215,0.26709813,0.26766369,0.26822880,0.26879352,0.26935777,
     # 0.26992163,0.27048507,0.27104807,0.27161068,0.27217284,0.27273461,
     # 0.27329597,0.27385691,0.27441743,0.27497754,0.27553725,0.27609658,
     # 0.27665550,0.27721399,0.27777210,0.27832982,0.27888712,0.27944404,
     # 0.28000057,0.28055671,0.28111246,0.28166780,0.28222278,0.28277737,
     # 0.28333157,0.28388542,0.28443885,0.28499192,0.28554460,0.28609693,
     # 0.28664887,0.28720045,0.28775167,0.28830251,0.28885296,0.28940308,
     # 0.28995281,0.29050222,0.29105124,0.29159990,0.29214820,0.29269618,
     # 0.29324377,0.29379103,0.29433793,0.29488447,0.29543069,0.29597655,
     # 0.29652208,0.29706725,0.29761207,0.29815659,0.29870075,0.29924458,
     # 0.29978806,0.30033123,0.30087405,0.30141655,0.30195874,0.30250058,
     # 0.30304211,0.30358329,0.30412418,0.30466476,0.30520499,0.30574492,
     # 0.30628452,0.30682382,0.30736279,0.30790147,0.30843985,0.30897790,
     # 0.30951566,0.31005311,0.31059024,0.31112710,0.31166363,0.31219989,
     # 0.31273583,0.31327149,0.31380683,0.31434190,0.31487668,0.31541115,
     # 0.31594536,0.31647927,0.31701291,0.31754625,0.31807929,0.31861207,
     # 0.31914458,0.31967679,0.32020873,0.32074040,0.32127178,0.32180291,
     # 0.32233375,0.32286432,0.32339466,0.32392469,0.32445446,0.32498398,
     # 0.32551324,0.32604221,0.32657096,0.32709941,0.32762763,0.32815558,
     # 0.32868329,0.32921073,0.32973793,0.33026487,0.33079156,0.33131802,
     # 0.33184421,0.33237016,0.33289587,0.33342135,0.33394656,0.33447155,
     # 0.33499628,0.33552080,0.33604506,0.33656910,0.33709288,0.33761644,
     # 0.33813980,0.33866289,0.33918577,0.33970842,0.34023082,0.34075302,
     # 0.34127498,0.34179673,0.34231827,0.34283957,0.34336063,0.34388149,
     # 0.34440213,0.34492257,0.34544280,0.34596279,0.34648257,0.34700215,
     # 0.34752151,0.34804067,0.34855962,0.34907836,0.34959689,0.35011524,
     # 0.35063335,0.35115129,0.35166901,0.35218653,0.35270384,0.35322097,
     # 0.35373789,0.35425463,0.35477117,0.35528749,0.35580364,0.35631961,
     # 0.35683537,0.35735095,0.35786635,0.35838154,0.35889655,0.35941139,
     # 0.35992602,0.36044049,0.36095476,0.36146885,0.36198279,0.36249653,
     # 0.36301008,0.36352345,0.36403665,0.36454970,0.36506253,0.36557522,
     # 0.36608773,0.36660007,0.36711225,0.36762422,0.36813605,0.36864772,
     # 0.36915922,0.36967054,0.37018171,0.37069270,0.37120354,0.37171420,
     # 0.37222472,0.37273508,0.37324527,0.37375531,0.37426516,0.37477490,
     # 0.37528446,0.37579387,0.37630311,0.37681222,0.37732115,0.37782997,
     # 0.37833861,0.37884709,0.37935546,0.37986365,0.38037157,0.38087934,
     # 0.38138697,0.38189444,0.38240176,0.38290912,0.38341632,0.38392338,
     # 0.38443032,0.38493720,0.38544393,0.38595054,0.38645700,0.38696334,
     # 0.38746941,0.38797536,0.38848117,0.38898683,0.38949239,0.38999778,
     # 0.39050305,0.39100820,0.39151323,0.39201811,0.39252287/
c
      data tpvel /
     # 9.17879105,7.61300802,6.79586744,6.23279190,5.82625723,5.52815056,
     # 5.30436897,5.13152695,4.99460268,4.88413000,4.79397631,4.71993494,
     # 4.65893507,4.60861206,4.56708860,4.53283310,4.50458956,4.48132133,
     # 4.46217108,4.44642878,4.43350840,4.42292309,4.41427135,4.40722036,
     # 4.40149355,4.39686537,4.39314318,4.39017200,4.38781977,4.38597870,
     # 4.38455772,4.38348246,4.38268995,4.38212681,4.38175201,4.38152790,
     # 4.38142490,4.38141823,4.38148689,4.38161278,4.38178253,4.38198423,
     # 4.38220692,4.38244295,4.38268566,4.38292980,4.38317013,4.38340330,
     # 4.38362646,4.38383722,4.38403368,4.38421440,4.38437796,4.38452339,
     # 4.38465071,4.38475895,4.38484764,4.38491726,4.38496685,4.38499737,
     # 4.38500786,4.38499975,4.38497210,4.38492537,4.38486052,4.38477707,
     # 4.38467503,4.38455534,4.38441801,4.38426352,4.38409138,4.38390303,
     # 4.38369751,4.38347578,4.38323832,4.38298416,4.38271475,4.38243008,
     # 4.38212967,4.38181448,4.38148451,4.38113928,4.38077974,4.38040543,
     # 4.38001728,4.37961435,4.37919807,4.37876701,4.37832260,4.37786436,
     # 4.37739229,4.37690687,4.37640762,4.37589502,4.37536860,4.37482929,
     # 4.37427664,4.37371063,4.37313128,4.37253857,4.37193251,4.37131357,
     # 4.37068129,4.37003613,4.36937761,4.36870575,4.36802053,4.36732244,
     # 4.36661053,4.36588621,4.36514807,4.36439657,4.36363173,4.36285353,
     # 4.36206198,4.36125660,4.36043787,4.35960531,4.35875988,4.35789967,
     # 4.35702658,4.35613966,4.35523844,4.35432339,4.35339451,4.35245132,
     # 4.35149384,4.35052252,4.34953642,4.34853601,4.34752131,4.34649181,
     # 4.34544754,4.34438896,4.34331512,4.34222651,4.34112310,4.34000397,
     # 4.33887005,4.33772087,4.33655596,4.33537579,4.33417940,4.33296824,
     # 4.33174038,4.33049870,4.32923985,4.32796431,4.32667351,4.32536554,
     # 4.32404280,4.32270384,4.32134485,4.31997299,4.31858015,4.31717348,
     # 4.31574821,4.31430721,4.31284904,4.31137228,4.30987501,4.30836296,
     # 4.30682945,4.30527735,4.30371189,4.30212307,4.30052185,4.29890203,
     # 4.29726362,4.29560757,4.29393244,4.29223919,4.29052734,4.28879690,
     # 4.28704786,4.28527975,4.28349304,4.28168678,4.27986193,4.27801800,
     # 4.27615452,4.27427244,4.27237034,4.27044964,4.26850891,4.26654911,
     # 4.26456976,4.26257086,4.26055193,4.25851393,4.25645638,4.25437880,
     # 4.25228167,4.25016451,4.24802780,4.24587154,4.24369526,4.24149942,
     # 4.23928404,4.23704863,4.23479319,4.23251820,4.23022366,4.22790909,
     # 4.22557497,4.22322130,4.22084808,4.21845484,4.21604252,4.21361065,
     # 4.21115923,4.20868826,4.20619822,4.20368862,4.20115995,4.19861221,
     # 4.19604540,4.19345951,4.19085503,4.18823195,4.18558979,4.18292904,
     # 4.18024969,4.17755270,4.17483759,4.17210436,4.16935349,4.16658449,
     # 4.16379833,4.16099405,4.15817308,4.15533447,4.15247917,4.14960670,
     # 4.14671803,4.14381266,4.14089108,4.13795328,4.13499975,4.13203001,
     # 4.12904501,4.12604475,4.12302923,4.11999893,4.11695385,4.11389446,
     # 4.11082077,4.10773277,4.10463142,4.10151577,4.09838724,4.09524584,
     # 4.09209108,4.08892393,4.08574438,4.08255243,4.07934856,4.07613325,
     # 4.07290697,4.06966877,4.06642008,4.06316090,4.05989122,4.05661154,
     # 4.05332184,4.05002260,4.04671431,4.04339695,4.04007053,4.03673553,
     # 4.03339291,4.03004169,4.02668333,4.02331686,4.01994371,4.01656389,
     # 4.01317739,4.00978422,4.00638533,4.00298023,3.99956989,3.99615407,
     # 3.99273348,3.98930812,3.98587823,3.98244429,3.97900629,3.97556448,
     # 3.97211933,3.96867108,3.96521997,3.96176624,3.95831013,3.95485163,
     # 3.95139146,3.94792962,3.94446611,3.94100189,3.93753648,3.93407035,
     # 3.93060374,3.92713714,3.92367053,3.92020392,3.91673803,3.91327286,
     # 3.90980840,3.90634513,3.90288329,3.89942312,3.89596462,3.89250803,
     # 3.88905382,3.88560200,3.88215256,3.87870598,3.87526250,3.87182212,
     # 3.86838508,3.86495161,3.86152196,3.85809612,3.85467458,3.85125709,
     # 3.84784412,3.84443569,3.84103203,3.83763337,3.83423972,3.83085132,
     # 3.82746840,3.82409072,3.82071900,3.81735301,3.81399298,3.81063914,
     # 3.80729127,3.80395031,3.80061555,3.79728770,3.79396653,3.79065228,
     # 3.78734517,3.78404522,3.78075242,3.77746701,3.77418900,3.77091885,
     # 3.76765609,3.76440144,3.76115465,3.75791574,3.75468493,3.75146246,
     # 3.74824810,3.74504209,3.74184465,3.73865581,3.73547578,3.73230410,
     # 3.72914147,3.72598767,3.72284269,3.71970677,3.71657991,3.71346235,
     # 3.71035409,3.70725489,3.70416498,3.70108438,3.69801354,3.69495201,
     # 3.69190025,3.68885827,3.68582559,3.68280292,3.67979002,3.67678714,
     # 3.67379379,3.67081046,3.66783714,3.66487408,3.66192079,3.65897751,
     # 3.65604472,3.65312171,3.65020895,3.64730668,3.64441442,3.64153242,
     # 3.63866091,3.63579965,3.63294888,3.63010836,3.62727833,3.62445855,
     # 3.62164950,3.61885071,3.61606264,3.61328483,3.61051774,3.60776114,
     # 3.60501504,3.60227942,3.59955454,3.59684014,3.59413648,3.59144330,
     # 3.58876085,3.58608890,3.58342767,3.58077717,3.57813716,3.57550764,
     # 3.57288909,3.57028103,3.56768370,3.56509686,3.56252074,3.55995536,
     # 3.55740047,3.55485630,3.55232286,3.54979992,3.54728770,3.54478598,
     # 3.54229498,3.53981447,3.53734469,3.53488541,3.53243685,3.52999854,
     # 3.52757120,3.52515411,3.52274776,3.52035189,3.51796627,3.51559138,
     # 3.51322699,3.51087308,3.50852966,3.50619674,3.50387406,3.50156188,
     # 3.49925995,3.49696875,3.49468756,3.49241686,3.49015641,3.48790646,
     # 3.48566651,3.48343706,3.48121786,3.47900867,3.47680974,3.47462106,
     # 3.47244263,3.47027421,3.46811604,3.46596766,3.46382976,3.46170163,
     # 3.45958352,3.45747542,3.45537734,3.45328927,3.45121121,3.44914293,
     # 3.44708443,3.44503593,3.44299698,3.44096804,3.43894887,3.43693948,
     # 3.43493962,3.43294954,3.43096924,3.42899823,3.42703724,3.42508554,
     # 3.42314363,3.42121100,3.41928816,3.41737461,3.41547036,3.41357565,
     # 3.41169047,3.40981436,3.40794778,3.40609026,3.40424228,3.40240335,
     # 3.40057349,3.39875293,3.39694166,3.39513922,3.39334607,3.39156175,
     # 3.38978672,3.38802052,3.38626313,3.38451481,3.38277531,3.38104486,
     # 3.37932301,3.37760997,3.37590575,3.37421036,3.37252355,3.37084532,
     # 3.36917591,3.36751485,3.36586261,3.36421871,3.36258340,3.36095667,
     # 3.35933828,3.35772824,3.35612655,3.35453320,3.35294843,3.35137153,
     # 3.34980321,3.34824300,3.34669089,3.34514689,3.34361100,3.34208345,
     # 3.34056377,3.33905196,3.33754826,3.33605266,3.33456469,3.33308482,
     # 3.33161283,3.33014846,3.32869196,3.32724333,3.32580233,3.32436895,
     # 3.32294321,3.32152534,3.32011485,3.31871200,3.31731653,3.31592870,
     # 3.31454825,3.31317520,3.31180978,3.31045151,3.30910063,3.30775714,
     # 3.30642080,3.30509162,3.30376983,3.30245519,3.30114746,3.29984713,
     # 3.29855371,3.29726744,3.29598808,3.29471564,3.29345036,3.29219174,
     # 3.29094028,3.28969550,3.28845763,3.28722644,3.28600216,3.28478456,
     # 3.28357363,3.28236938,3.28117180,3.27998066,3.27879620,3.27761841,
     # 3.27644706,3.27528214,3.27412367,3.27297163,3.27182603,3.27068663,
     # 3.26955366,3.26842713,3.26730680,3.26619267,3.26508474,3.26398301,
     # 3.26288748,3.26179790,3.26071453,3.25963736,3.25856590,3.25750065,
     # 3.25644135,3.25538802,3.25434065,3.25329900,3.25226355,3.25123358,
     # 3.25020957,3.24919128,3.24817872,3.24717188,3.24617076,3.24517536,
     # 3.24418545,3.24320126,3.24222279,3.24124956,3.24028206,3.23932004,
     # 3.23836327,3.23741221,3.23646641,3.23552608,3.23459101,3.23366094,
     # 3.23273635,3.23181653,3.23090172,3.22999334,3.22909021,3.22819233,
     # 3.22729945,3.22641158,3.22552848,3.22465086,3.22377849,3.22291112,
     # 3.22204828,3.22119045,3.22033763,3.21948957,3.21864653,3.21780825,
     # 3.21697474,3.21614623,3.21532249,3.21450329,3.21368909/
c
      data somega /
     # 0.00194327,0.00294407,0.00406573,0.00528063,0.00652341,0.00773970,
     # 0.00888144,0.00991674,0.01084782,0.01170198,0.01250596,0.01327604,
     # 0.01402037,0.01474283,0.01544548,0.01612975,0.01679691,0.01744832,
     # 0.01808540,0.01870965,0.01932258,0.01992564,0.02052024,0.02110765,
     # 0.02168906,0.02226550,0.02283790,0.02340707,0.02397371,0.02453840,
     # 0.02510166,0.02566391,0.02622550,0.02678673,0.02734784,0.02790903,
     # 0.02847045,0.02903225,0.02959453,0.03015735,0.03072079,0.03128488,
     # 0.03184966,0.03241515,0.03298136,0.03354830,0.03411597,0.03468436,
     # 0.03525347,0.03582329,0.03639381,0.03696500,0.03753686,0.03810938,
     # 0.03868253,0.03925630,0.03983068,0.04040565,0.04098120,0.04155730,
     # 0.04213395,0.04271113,0.04328883,0.04386703,0.04444573,0.04502491,
     # 0.04560457,0.04618468,0.04676525,0.04734625,0.04792769,0.04850956,
     # 0.04909183,0.04967453,0.05025762,0.05084110,0.05142498,0.05200923,
     # 0.05259386,0.05317887,0.05376424,0.05434996,0.05493604,0.05552248,
     # 0.05610926,0.05669638,0.05728384,0.05787164,0.05845976,0.05904821,
     # 0.05963698,0.06022607,0.06081548,0.06140519,0.06199522,0.06258555,
     # 0.06317618,0.06376711,0.06435833,0.06494985,0.06554165,0.06613375,
     # 0.06672611,0.06731876,0.06791168,0.06850488,0.06909835,0.06969208,
     # 0.07028607,0.07088032,0.07147484,0.07206959,0.07266460,0.07325986,
     # 0.07385536,0.07445109,0.07504706,0.07564326,0.07623969,0.07683635,
     # 0.07743323,0.07803032,0.07862763,0.07922515,0.07982288,0.08042081,
     # 0.08101894,0.08161727,0.08221579,0.08281449,0.08341339,0.08401247,
     # 0.08461173,0.08521116,0.08581076,0.08641053,0.08701047,0.08761057,
     # 0.08821081,0.08881123,0.08941178,0.09001248,0.09061333,0.09121431,
     # 0.09181543,0.09241669,0.09301807,0.09361958,0.09422120,0.09482295,
     # 0.09542482,0.09602679,0.09662887,0.09723106,0.09783335,0.09843574,
     # 0.09903822,0.09964079,0.10024345,0.10084620,0.10144903,0.10205194,
     # 0.10265492,0.10325797,0.10386109,0.10446429,0.10506754,0.10567085,
     # 0.10627422,0.10687765,0.10748113,0.10808466,0.10868822,0.10929184,
     # 0.10989549,0.11049918,0.11110290,0.11170666,0.11231044,0.11291425,
     # 0.11351808,0.11412194,0.11472581,0.11532969,0.11593359,0.11653750,
     # 0.11714142,0.11774534,0.11834926,0.11895319,0.11955711,0.12016103,
     # 0.12076494,0.12136885,0.12197273,0.12257661,0.12318047,0.12378432,
     # 0.12438814,0.12499194,0.12559570,0.12619945,0.12680317,0.12740687,
     # 0.12801051,0.12861413,0.12921771,0.12982126,0.13042475,0.13102821,
     # 0.13163161,0.13223498,0.13283828,0.13344154,0.13404475,0.13464791,
     # 0.13525100,0.13585404,0.13645701,0.13705993,0.13766277,0.13826555,
     # 0.13886827,0.13947092,0.14007349,0.14067599,0.14127842,0.14188077,
     # 0.14248304,0.14308523,0.14368734,0.14428937,0.14489131,0.14549316,
     # 0.14609493,0.14669661,0.14729820,0.14789970,0.14850111,0.14910242,
     # 0.14970362,0.15030473,0.15090574,0.15150666,0.15210746,0.15270817,
     # 0.15330876,0.15390925,0.15450963,0.15510990,0.15571006,0.15631010,
     # 0.15691003,0.15750985,0.15810955,0.15870912,0.15930858,0.15990791,
     # 0.16050713,0.16110621,0.16170518,0.16230401,0.16290273,0.16350131,
     # 0.16409975,0.16469806,0.16529626,0.16589430,0.16649221,0.16708998,
     # 0.16768761,0.16828512,0.16888246,0.16947967,0.17007674,0.17067367,
     # 0.17127044,0.17186707,0.17246355,0.17305988,0.17365605,0.17425208,
     # 0.17484795,0.17544366,0.17603922,0.17663462,0.17722987,0.17782494,
     # 0.17841986,0.17901462,0.17960921,0.18020365,0.18079790,0.18139200,
     # 0.18198593,0.18257968,0.18317327,0.18376668,0.18435992,0.18495299,
     # 0.18554588,0.18613859,0.18673111,0.18732348,0.18791565,0.18850763,
     # 0.18909945,0.18969107,0.19028251,0.19087376,0.19146483,0.19205569,
     # 0.19264637,0.19323687,0.19382717,0.19441727,0.19500718,0.19559689,
     # 0.19618641,0.19677573,0.19736485,0.19795376,0.19854248,0.19913098,
     # 0.19971929,0.20030740,0.20089529,0.20148297,0.20207044,0.20265771,
     # 0.20324476,0.20383161,0.20441823,0.20500465,0.20559084,0.20617682,
     # 0.20676258,0.20734811,0.20793343,0.20851852,0.20910339,0.20968804,
     # 0.21027246,0.21085666,0.21144062,0.21202436,0.21260786,0.21319114,
     # 0.21377417,0.21435697,0.21493955,0.21552187,0.21610397,0.21668583,
     # 0.21726744,0.21784882,0.21842995,0.21901083,0.21959148,0.22017187,
     # 0.22075202,0.22133192,0.22191158,0.22249097,0.22307011,0.22364901,
     # 0.22422765,0.22480604,0.22538416,0.22596203,0.22653964,0.22711699,
     # 0.22769408,0.22827090,0.22884746,0.22942375,0.22999978,0.23057553,
     # 0.23115103,0.23172624,0.23230121,0.23287587,0.23345028,0.23402441,
     # 0.23459826,0.23517184,0.23574513,0.23631814,0.23689088,0.23746334,
     # 0.23803550,0.23860739,0.23917899,0.23975030,0.24032132,0.24089207,
     # 0.24146250,0.24203266,0.24260251,0.24317208,0.24374135,0.24431032,
     # 0.24487899,0.24544737,0.24601544,0.24658322,0.24715069,0.24771787,
     # 0.24828473,0.24885128,0.24941754,0.24998349,0.25054911,0.25111443,
     # 0.25167945,0.25224414,0.25280854,0.25337261,0.25393635,0.25449979,
     # 0.25506291,0.25562569,0.25618815,0.25675032,0.25731215,0.25787362,
     # 0.25843480,0.25899565,0.25955617,0.26011637,0.26067623,0.26123574,
     # 0.26179495,0.26235381,0.26291233,0.26347050,0.26402837,0.26458588,
     # 0.26514304,0.26569986,0.26625636,0.26681250,0.26736829,0.26792374,
     # 0.26847884,0.26903361,0.26958802,0.27014208,0.27069578,0.27124912,
     # 0.27180213,0.27235475,0.27290705,0.27345899,0.27401054,0.27456176,
     # 0.27511263,0.27566311,0.27621323,0.27676299,0.27731240,0.27786142,
     # 0.27841008,0.27895838,0.27950633,0.28005388,0.28060105,0.28114787,
     # 0.28169429,0.28224036,0.28278604,0.28333136,0.28387630,0.28442085,
     # 0.28496504,0.28550881,0.28605223,0.28659526,0.28713790,0.28768015,
     # 0.28822201,0.28876352,0.28930461,0.28984532,0.29038563,0.29092556,
     # 0.29146507,0.29200423,0.29254296,0.29308131,0.29361928,0.29415682,
     # 0.29469398,0.29523075,0.29576710,0.29630306,0.29683861,0.29737374,
     # 0.29790848,0.29844284,0.29897678,0.29951030,0.30004343,0.30057612,
     # 0.30110845,0.30164033,0.30217180,0.30270287,0.30323353,0.30376378,
     # 0.30429360,0.30482301,0.30535200,0.30588058,0.30640873,0.30693647,
     # 0.30746377,0.30799067,0.30851713,0.30904320,0.30956882,0.31009403,
     # 0.31061879,0.31114316,0.31166708,0.31219056,0.31271365,0.31323627,
     # 0.31375849,0.31428027,0.31480160,0.31532252,0.31584302,0.31636307,
     # 0.31688267,0.31740186,0.31792060,0.31843892,0.31895679,0.31947422,
     # 0.31999120,0.32050776,0.32102388,0.32153955,0.32205477,0.32256958,
     # 0.32308391,0.32359782,0.32411128,0.32462430,0.32513687,0.32564899,
     # 0.32616070,0.32667193,0.32718271,0.32769305,0.32820293,0.32871237,
     # 0.32922137,0.32972991,0.33023801,0.33074567,0.33125284,0.33175957,
     # 0.33226585,0.33277169,0.33327708,0.33378202,0.33428648,0.33479050,
     # 0.33529404,0.33579716,0.33629981,0.33680201,0.33730373,0.33780500,
     # 0.33830583,0.33880618,0.33930609,0.33980554,0.34030452,0.34080303,
     # 0.34130108,0.34179869,0.34229583,0.34279251,0.34328875,0.34378448,
     # 0.34427980,0.34477463,0.34526899,0.34576291,0.34625635,0.34674934,
     # 0.34724188,0.34773391,0.34822550,0.34871665,0.34920731,0.34969750,
     # 0.35018724,0.35067654,0.35116532,0.35165367,0.35214156,0.35262895,
     # 0.35311592,0.35360238,0.35408840,0.35457397,0.35505903,0.35554364,
     # 0.35602781,0.35651150,0.35699472,0.35747746,0.35795975,0.35844156,
     # 0.35892293,0.35940382,0.35988423,0.36036420,0.36084369,0.36132273,
     # 0.36180127,0.36227936,0.36275700,0.36323416,0.36371085,0.36418709,
     # 0.36466286,0.36513814,0.36561298,0.36608735,0.36656123,0.36703467,
     # 0.36750764,0.36798015,0.36845219,0.36892378,0.36939490,0.36986554,
     # 0.37033573,0.37080544,0.37127471,0.37174350,0.37221184,0.37267971,
     # 0.37314710,0.37361404,0.37408054,0.37454656,0.37501213,0.37547722,
     # 0.37594184,0.37640601,0.37686974,0.37733302,0.37779579,0.37825814,
     # 0.37872002,0.37918144,0.37964240,0.38010290,0.38056293,0.38102254,
     # 0.38148165,0.38194034,0.38239855,0.38285631,0.38331363,0.38377050,
     # 0.38422689,0.38468283,0.38513833,0.38559335,0.38604796,0.38650209,
     # 0.38695577,0.38740900,0.38786179,0.38831404,0.38876596,0.38921741,
     # 0.38966838,0.39011893,0.39056900,0.39101866,0.39146784,0.39191660,
     # 0.39236489/
c
      data spvel /
     # 6.39109182,6.70532084,7.51172256,7.88421440,7.88004065,7.55123425,
     # 6.94628572,6.23629856,5.64826536,5.25375748,4.99700928,4.81332636,
     # 4.66454124,4.53290462,4.41150379,4.29837894,4.19354010,4.09755564,
     # 4.01093674,3.93391252,3.86639047,3.80799985,3.75816417,3.71617436,
     # 3.68125391,3.65261030,3.62946939,3.61110115,3.59683299,3.58605838,
     # 3.57823658,3.57289243,3.56961179,3.56803775,3.56786323,3.56882691,
     # 3.57070708,3.57331800,3.57650280,3.58013010,3.58409119,3.58829594,
     # 3.59267044,3.59715414,3.60169816,3.60626268,3.61081648,3.61533427,
     # 3.61979699,3.62418938,3.62850189,3.63272595,3.63685632,3.64088964,
     # 3.64482474,3.64866138,3.65240026,3.65604329,3.65959239,3.66305065,
     # 3.66642118,3.66970706,3.67291212,3.67603970,3.67909312,3.68207645,
     # 3.68499327,3.68784618,3.69063902,3.69337511,3.69605756,3.69868898,
     # 3.70127225,3.70380998,3.70630431,3.70875788,3.71117282,3.71355057,
     # 3.71589375,3.71820331,3.72048140,3.72272921,3.72494817,3.72713947,
     # 3.72930408,3.73144293,3.73355699,3.73564744,3.73771453,3.73975921,
     # 3.74178171,3.74378276,3.74576283,3.74772191,3.74966073,3.75157928,
     # 3.75347781,3.75535655,3.75721574,3.75905490,3.76087475,3.76267505,
     # 3.76445556,3.76621652,3.76795793,3.76967955,3.77138138,3.77306318,
     # 3.77472496,3.77636671,3.77798820,3.77958941,3.78117013,3.78273034,
     # 3.78426957,3.78578806,3.78728557,3.78876185,3.79021692,3.79165053,
     # 3.79306269,3.79445314,3.79582214,3.79716921,3.79849434,3.79979753,
     # 3.80107880,3.80233788,3.80357480,3.80478930,3.80598187,3.80715203,
     # 3.80830002,3.80942559,3.81052876,3.81160975,3.81266832,3.81370473,
     # 3.81471848,3.81571031,3.81667995,3.81762743,3.81855297,3.81945634,
     # 3.82033777,3.82119751,3.82203531,3.82285166,3.82364607,3.82441926,
     # 3.82517099,3.82590127,3.82661057,3.82729888,3.82796621,3.82861257,
     # 3.82923841,3.82984376,3.83042860,3.83099318,3.83153772,3.83206248,
     # 3.83256721,3.83305264,3.83351827,3.83396482,3.83439207,3.83480024,
     # 3.83518982,3.83556056,3.83591270,3.83624673,3.83656240,3.83685994,
     # 3.83713984,3.83740187,3.83764648,3.83787346,3.83808351,3.83827639,
     # 3.83845258,3.83861184,3.83875465,3.83888125,3.83899140,3.83908558,
     # 3.83916378,3.83922625,3.83927321,3.83930469,3.83932066,3.83932185,
     # 3.83930802,3.83927917,3.83923578,3.83917785,3.83910561,3.83901882,
     # 3.83891821,3.83880353,3.83867526,3.83853292,3.83837700,3.83820772,
     # 3.83802557,3.83782983,3.83762145,3.83739996,3.83716583,3.83691835,
     # 3.83665895,3.83638716,3.83610320,3.83580685,3.83549857,3.83517814,
     # 3.83484602,3.83450222,3.83414650,3.83377957,3.83340096,3.83301115,
     # 3.83261013,3.83219790,3.83177471,3.83134031,3.83089542,3.83043957,
     # 3.82997298,3.82949567,3.82900810,3.82851005,3.82800150,3.82748294,
     # 3.82695389,3.82641482,3.82586575,3.82530665,3.82473755,3.82415891,
     # 3.82357025,3.82297182,3.82236385,3.82174635,3.82111931,3.82048273,
     # 3.81983685,3.81918144,3.81851673,3.81784296,3.81715989,3.81646776,
     # 3.81576633,3.81505609,3.81433678,3.81360865,3.81287146,3.81212544,
     # 3.81137061,3.81060719,3.80983472,3.80905390,3.80826426,3.80746603,
     # 3.80665922,3.80584383,3.80501986,3.80418754,3.80334663,3.80249739,
     # 3.80163980,3.80077386,3.79989958,3.79901695,3.79812622,3.79722714,
     # 3.79631972,3.79540420,3.79448032,3.79354858,3.79260850,3.79166055,
     # 3.79070425,3.78974009,3.78876781,3.78778744,3.78679919,3.78580284,
     # 3.78479862,3.78378606,3.78276587,3.78173757,3.78070140,3.77965736,
     # 3.77860546,3.77754569,3.77647805,3.77540255,3.77431893,3.77322793,
     # 3.77212882,3.77102184,3.76990724,3.76878476,3.76765442,3.76651645,
     # 3.76537037,3.76421690,3.76305556,3.76188636,3.76070929,3.75952482,
     # 3.75833225,3.75713229,3.75592422,3.75470877,3.75348520,3.75225401,
     # 3.75101495,3.74976850,3.74851418,3.74725223,3.74598265,3.74470520,
     # 3.74342012,3.74212718,3.74082661,3.73951840,3.73820257,3.73687887,
     # 3.73554754,3.73420858,3.73286176,3.73150730,3.73014522,3.72877526,
     # 3.72739792,3.72601247,3.72461963,3.72321892,3.72181058,3.72039437,
     # 3.71897078,3.71753931,3.71609998,3.71465302,3.71319842,3.71173620,
     # 3.71026611,3.70878839,3.70730281,3.70580983,3.70430875,3.70280027,
     # 3.70128393,3.69975972,3.69822788,3.69668818,3.69514084,3.69358587,
     # 3.69202304,3.69045258,3.68887448,3.68728852,3.68569493,3.68409348,
     # 3.68248439,3.68086743,3.67924285,3.67761040,3.67597032,3.67432237,
     # 3.67266679,3.67100334,3.66933227,3.66765332,3.66596675,3.66427255,
     # 3.66257048,3.66086054,3.65914297,3.65741754,3.65568447,3.65394378,
     # 3.65219522,3.65043879,3.64867473,3.64690280,3.64512324,3.64333606,
     # 3.64154100,3.63973808,3.63792753,3.63610935,3.63428330,3.63244963,
     # 3.63060808,3.62875891,3.62690210,3.62503719,3.62316465,3.62128448,
     # 3.61939669,3.61750102,3.61559796,3.61368704,3.61176825,3.60984206,
     # 3.60790801,3.60596633,3.60401678,3.60205984,3.60009503,3.59812260,
     # 3.59614253,3.59415507,3.59215975,3.59015679,3.58814621,3.58612800,
     # 3.58410215,3.58206868,3.58002758,3.57797885,3.57592273,3.57385898,
     # 3.57178760,3.56970882,3.56762242,3.56552839,3.56342697,3.56131792,
     # 3.55920124,3.55707741,3.55494595,3.55280685,3.55066037,3.54850674,
     # 3.54634523,3.54417658,3.54200053,3.53981709,3.53762603,3.53542781,
     # 3.53322220,3.53100920,3.52878904,3.52656150,3.52432656,3.52208447,
     # 3.51983500,3.51757836,3.51531458,3.51304364,3.51076531,3.50847983,
     # 3.50618720,3.50388765,3.50158072,3.49926686,3.49694586,3.49461770,
     # 3.49228263,3.48994064,3.48759151,3.48523545,3.48287225,3.48050237,
     # 3.47812533,3.47574162,3.47335076,3.47095323,3.46854901,3.46613812,
     # 3.46372032,3.46129560,3.45886445,3.45642638,3.45398188,3.45153046,
     # 3.44907260,3.44660830,3.44413733,3.44165969,3.43917561,3.43668532,
     # 3.43418837,3.43168497,3.42917514,3.42665911,3.42413664,3.42160797,
     # 3.41907310,3.41653204,3.41398454,3.41143107,3.40887141,3.40630555,
     # 3.40373373,3.40115595,3.39857221,3.39598227,3.39338660,3.39078498,
     # 3.38817739,3.38556409,3.38294506,3.38032031,3.37768960,3.37505341,
     # 3.37241173,3.36976409,3.36711121,3.36445260,3.36178875,3.35911918,
     # 3.35644436,3.35376406,3.35107851,3.34838772,3.34569168,3.34299040,
     # 3.34028411,3.33757257,3.33485603,3.33213449,3.32940769,3.32667613,
     # 3.32393980,3.32119846,3.31845236,3.31570148,3.31294584,3.31018567,
     # 3.30742073,3.30465150,3.30187750,3.29909897,3.29631591,3.29352856,
     # 3.29073691,3.28794074,3.28514051,3.28233624,3.27952766,3.27671480,
     # 3.27389812,3.27107739,3.26825261,3.26542401,3.26259160,3.25975513,
     # 3.25691509,3.25407124,3.25122380,3.24837279,3.24551821,3.24266028,
     # 3.23979855,3.23693371,3.23406553,3.23119402,3.22831917,3.22544122,
     # 3.22255993,3.21967578,3.21678877,3.21389842,3.21100545,3.20810938,
     # 3.20521069,3.20230913,3.19940495,3.19649816,3.19358873,3.19067669,
     # 3.18776226,3.18484521,3.18192601,3.17900443,3.17608070,3.17315459,
     # 3.17022610,3.16729617,3.16436362,3.16142941,3.15849304,3.15555501,
     # 3.15261531,3.14967370,3.14673042,3.14378548,3.14083910,3.13789105,
     # 3.13494158,3.13199067,3.12903857,3.12608504,3.12313032,3.12017441,
     # 3.11721730,3.11425924,3.11130023,3.10834002,3.10537910,3.10241723,
     # 3.09945488,3.09649158,3.09352779,3.09056330,3.08759832,3.08463264,
     # 3.08166671,3.07870030,3.07573366,3.07276678,3.06979966,3.06683254,
     # 3.06386518,3.06089783,3.05793047,3.05496335,3.05199623,3.04902935,
     # 3.04606271,3.04309654,3.04013062,3.03716493,3.03419995,3.03123546,
     # 3.02827168,3.02530837,3.02234578,3.01938391,3.01642299,3.01346302,
     # 3.01050377,3.00754547,3.00458837,3.00163221,2.99867725,2.99572349,
     # 2.99277115,2.98982000,2.98687005,2.98392177,2.98097467,2.97802925,
     # 2.97508550,2.97214317,2.96920252,2.96626377,2.96332669,2.96039128,
     # 2.95745802,2.95452666,2.95159721,2.94866967,2.94574428,2.94282103,
     # 2.93990016,2.93698120,2.93406463,2.93115044,2.92823863,2.92532921,
     # 2.92242241,2.91951799,2.91661620,2.91371703,2.91082048,2.90792656,
     # 2.90503550,2.90214729,2.89926195,2.89637947,2.89349985,2.89062333,
     # 2.88774967,2.88487911,2.88201189,2.87914634,2.87628627,2.87342858,
     # 2.87057400,2.86772275,2.86487508,2.86203074,2.85918975,2.85635233,
     # 2.85351849/
c
      if(.not.splined) then
        if(iprtlv.gt.1) then
        write(6,"('there are ',i5,' toroidal modes in spline')") ntspl
        write(6,"('there are ',i5,' spheroidal modes in spline')") nsspl
        endif
        call rspln(1,ntspl,tomega,tpvel,tcube,work)
        call rspln(1,nsspl,somega,spvel,scube,work)
        splined=.true.
      endif
c
      if(modetype.eq.1) then
        pvel=rsple(1,ntspl,tomega,tpvel,tcube,omega)
      else
        pvel=rsple(1,nsspl,somega,spvel,scube,omega)
      endif
      premgegrvelo=pvel
      return
      end
